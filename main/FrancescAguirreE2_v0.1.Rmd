---
title: "Entrega 2: Genome-wide Association Studies"
subtitle: "Big Data en Biociències"
author: "Francesc Aguirre, 1398024"
date: "Gener de 2021"
output:
  html_document: 
    toc: true
editor_options: 
  chunk_output_type: console
---

<style type="text/css">

body{ /* Normal  */
      font-size: 16px;
  }
td {  /* Table  */
  font-size: 18px;
}
h1.title {
  font-size: 38px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 28px;
  color: DarkGreen;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: DarkRed;
}
h3 { /* Header 3 */
  font-size: 18px;
  font-family: "Times New Roman", Times, serif;
  color: DarkRed;
}
code.r{ /* Code block */
    font-size: 16px;
}

</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(xtable)
options(xtable.comment = FALSE)
```


# 1. Objectiu

Detectar nous SNPs associats a l'index de massa corporal (bmi), utilitzant les dades *coronary*.


# 2. Metodologia, anàlisi de dades i resultats

## 2.1 Obtenció de les dades i paquets

### 2.1.1 Paquets estadístics d'R

```{r message = FALSE}
library(snpStats)
library(magrittr)
```

S'utilitzarà el paquet estadístic **snpStats** per facilitar l'anàlisi genètica GWAS, i el paquet **magrittr** per la creació de pipelines.

Qualsevol funció o codi R que no surti en aquest document es pot trobar a [github](https://github.com/cesc1/GWAS-example) (secció ANNEX).


### 2.1.2 Taula de dades

```{r}
setwd("..")
root_path <- getwd()

dataG <- read.plink(paste0(root_path, "/data/coronary"))
dataS <- read.table(paste0(root_path, "/data/coronary.txt"), 
                    header = T, row.names = "id") # id s'ha fixat com a nom de fila
source(paste0(root_path, "/code/GWAS.R"))
```

S'han utilitzat dades d'un estudi epidemiològic sobre el bmi, on s'inclou la informació genètica de `r nrow(dataS)` individus en format plink, a més del gènere, edat, estat de fumador i el bmi.


## 2.2 Control de qualitat

### 2.2.1 ID match

S'ha comprobat que els identificadors dels dos fitxers de dades coincideixen, i estàn en el mateix ordre.

```{r}
dataS <- id_match(data = dataS, id = dataG$fam$member)
```

Si tornem a executar la funció, podem comprobar que els identificadors dels dos fitxer coincideixen.

```{r}
dataS <- id_match(dataS, dataG$fam$member)
```


### 2.2.2 






# 3. Conclusions

# ANNEX

El codi d'aquesta entrega es pot trobar a github: [cesc1/GWAS-example](https://github.com/cesc1/GWAS-example).

- code: Funcions utilitzades en l'entrega.
- main: Document .Rdm amb el respectiu .html entregat.
- data: Dades utilitzades asthma, i taules de dades creades.

